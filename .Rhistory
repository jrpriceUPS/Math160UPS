confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
source('~/Dropbox/Teaching/Math 160/Math160UPS/R/confint_activity.R', echo=TRUE)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
confint_activity(numstudents = 2800)
document()
rm(list = c("confint_activity"))
document()
update_code()\
update_code()
stat.test()
stat.test()
stat.test()
hyp_test_activity(section_name = "sectionD")
hyp_test_activity(section_name = "sectionD")
hyp_test_activity(section_name = "sectionD")
hyp_test_activity(section_name = "sectionD")
hyp_test_activity(section_name = "sectionD")
hyp_test_activity(section_name = "sectionD")
hyp_test_activity(section_name = "sectionD")
hyp_test_activity(section_name = "sectionD")
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
hyp_test_activity(numstudents = 2000)
.65*.35/20
sqrt(.65*.35/20)
V = -1.199408065112838
1-V^2
1-V^2-.064
(1-V^2)*.064-(-1*.08)
-0.5025797
(-0.5025797)^2
4*0.0519309
(-0.5025797)^2/4
-.4386-.064
-.4386*.064+.08
-0.5026*-0.5026/4
-0.5026*-0.5026-4*(-.4386*.064+.08)
a = 1-V^2
b = -1
c = 0.08
d = -.064
T = a + d
D = a*d-b*c
T^2-4*D
T
D
1-.064
-.064+.08
x = file.choose()
head(x)
x
x = file.choose()
x = read.csv(file.choose())
head(x)
mean(x$Total.Enrollment)
View(x)
subset(x,Career == "UGRD")
mean(subset(x,Career == "UGRD")$Total.Enrollment)
setwd("~/Dropbox/Teaching/Comprehensive Review/32Teaching")
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
head(classes)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
table(classes$Units)
View(subset(classes,classes$Units == 0))
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
head(classesLabs)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
head(classesLabs)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
head(classes)
table(classes$Units)
classes[classes$Units == 1.5]
classes[classes$Units == 1.5,]
table(classes[classes$Units == 1.5,],Career)
table(classes[classes$Units == 1.5,]$Career)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
classes[classes$Units == 0.5,]
table(classes$Component)
subset(classes, Component == "PER")
subset(classes, Component == "PRA")
subset(classes, Component == "RSC")
subset(classes, Component == "SEM")
View(subset(classes, Component == "SEM"))
subset(classes, Component == "THE")
subset(classes, Component == "THT")
table(classes$Component)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
subset(classes$Units == 0)
subset(classes,Units == 0)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
table(classes$Units)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
head(classes)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
summaryTable$TotalUnits
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
head(classes)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
summaryTable$TotalClasses*2
table(classes$Component)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
#classes <- subset(classes, Component == "LEC" | Component == "PER" | Component == "SEM")
table(classes$Component)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
subset(classes,Units == 0)
table(subset(classes,Units == 0)$Career)
table(subset(classes,Units == 0)$Component)
subset(classes,Units == 0,Component == "SEM")
subset(classes,Units == 0&Component == "SEM")
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
mean(enrollmentData)
(530+537+491+466)/2
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
table(classes$Units)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
table(classes$Units)
subset(classes,Units == 1.5)
subset(classes,Units == 2)
subset(classes,Units == 2.5)
table(classes$Units)
subset(classes,Units == 0.75)
table(subset(classes,Units == 0.75)$Subject)
table(classes$Units)
View(subset(classes,Units == 0.5))
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
table(classes$Units)
table(classes$Units)
View(subset(classes,Units == 0.5))
View(subset(classes,Units == 0.5))
View(subset(classes,Units == 0.25))
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
mean(enrollmentData)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
table(classes$Component)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
table(classes$Units)
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
table(classes$Units)
subset(classes,Units < 1)
group_by(subset(classes,Units < 1),term)
group_by(subset(classes,Units < 1),Term)
summarize(group_by(subset(classes,Units < 1),Term),length(Component))
source('~/Dropbox/Teaching/Comprehensive Review/32Teaching/threeTwoData.R', echo=TRUE)
(.42-.5)/.016
sqrt(.24*.76/603)
sqrt(.42*.58/1000)
mean(classes$Total.Enrollment<=20)
mean(classes$Total.Enrollment==21)
8+7+2
.2379/.0015
.02/1.96
hist(students$Sleep)
t_dist_demo()
t_dist_demo()
t_dist_demo()
t_dist_demo()
?t_dist_demo
t_dist_demo(n = 25)
t_dist_demo(n = 25)
t_dist_demo(n = 25)
t_dist_demo(n = 25)
t_dist_demo(n = 25)
t_dist_demo(n = 2)
t_dist_demo(n = 2)
t_dist_demo(n = 2)
t_dist_demo(n = 2)
t_dist_demo(n = 2)
t_dist_demo(n = 2)
t_dist_demo(n = 2)
t_dist_demo(n = 3)
t_dist_demo(n = 3)
t_dist_demo(n = 3)
t_dist_demo(n = 3)
sample(students$Sleep,10)
stat.test()
ls
setwd("~/Dropbox/Teaching/Comprehensive Review/EducationGoals")
x = read.csv("EdGoalsMajor.csv
")
x = read.csv("EdGoalsMajor.csv")
head(x)
x = read.csv("EdGoalsMajor.csv")
head(x)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
nrow(EdGoals)
EdGoals = read.csv("EdGoalsMajor.csv")
head(EdGoals)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
firstYears$AVG
EdGoals = read.csv("EdGoalsMajor.csv")
EdGoals = subset(EdGoals,Statistic == "Average")
firstYears = subset(EdGoals,Class == "First-Year")
soph = subset(EdGoals,Class == "Sophomore")
jun = subset(EdGoals,Class == "Junior")
sen = subset(EdGoals, Class = "Senior")
firstYears$AVG
firstYears$AVG*firstYears$Count
(firstYears$AVG*firstYears$Count +
soph$AVG*soph$Count +
jun$AVG*jun$Count +
sen$AVG*sen$Count)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
summaryFrame = data.frame(Programs = firstYears$Programs, Avg = (firstYears$AVG*firstYears$Count +
soph$AVG*soph$Count +
jun$AVG*jun$Count +
sen$AVG*sen$Count)/(firstYears$Count + soph$Count + jun$Count + sen$Count))
summaryFrame
lattice::densityplot(~Avg, data = summaryFrame)
summaryFrame = data.frame(Programs = firstYears$Programs, Avg = (firstYears$AVG*firstYears$Count +
soph$AVG*soph$Count +
jun$AVG*jun$Count +
sen$AVG*sen$Count)/(firstYears$Count + soph$Count + jun$Count + sen$Count),
n = (firstYears$Count + soph$Count + jun$Count + sen$Count))
lattice::xyplot(Avg~n, data = summaryFrame)
lattice::xyplot(log(Avg)~n, data = summaryFrame)
lattice::xyplot(Avg~log(n), data = summaryFrame)
lattice::xyplot(log(Avg)~log(n), data = summaryFrame)
lattice::xyplot(Avg~1/n, data = summaryFrame)
lattice::xyplot(1/Avg~1/n, data = summaryFrame)
lattice::xyplot(log(Avg)~1/n, data = summaryFrame)
lattice::xyplot(Avg~1/n, data = summaryFrame)
lattice::xyplot(Avg~n, data = summaryFrame)
View(summaryFrame)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
View(summaryFrame)
firstYears$Programs
nrow(summaryFrame)
unique(firstYears$Programs)
length(unique(firstYears$Programs))
View(firstYears$Programs)
View(firstYears$)
View(firstYears)
nrow(firstYears)
firstYears$Programs
(firstYears$AVG*firstYears$Count +
soph$AVG*soph$Count +
jun$AVG*jun$Count +
sen$AVG*sen$Count)/(firstYears$Count + soph$Count + jun$Count + sen$Count)
firstYears$AVG
firstYears$AVG*firstYears$Count
soph$AVG*soph$Count
jun$AVG*jun$Count
sen$AVG*sen$Count
View(sen)
subset(EdGoals, Class = "Senior")
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
source('~/Dropbox/Teaching/Comprehensive Review/EducationGoals/EdGoalsAnalysis.R', echo=TRUE)
lattice::xyplot(Avg~log(n), data = summaryFrame)
lattice::xyplot(log(Avg)~log(n), data = summaryFrame)
lattice::xyplot(log(Avg)~n, data = summaryFrame)
lattice::xyplot(Avg~1/n, data = summaryFrame)
stat.test()
stat.test()
arccos(.5)
acos(.5)
pi/2
pi/3
sin(pi/3)
atan((1+sqrt(3)/2)/(3/2))
cos(atan((1+sqrt(3)/2)/(3/2)))*4/3
x = cos(atan((1+sqrt(3)/2)/(3/2)))*4/3
4*x^2
4*x^2+4*.5*x*sqrt(3)*x/2
t.test(students$ShoeSz,mu = 9)
hist(students$ShoeSz)
mean(students$ShoeSz)
sd(students$ShoeSz)
data(modern_polar_T)
head(modern_polar_T)
plot(modern_Polar_T$DATE,modern_Polar_T$TAVG)
plot(modern_polar_T$DATE,modern_polar_T$TAVG)
data("modern_T")
get_modern_T("https://data.giss.nasa.gov/gistemp/graphs/graph_data/Global_Mean_Estimates_based_on_Land_and_Ocean_Data/graph.txt")
read_modern_T("https://data.giss.nasa.gov/gistemp/graphs/graph_data/Global_Mean_Estimates_based_on_Land_and_Ocean_Data/graph.txt")
modern_T
modern_T = read_modern_T("https://data.giss.nasa.gov/gistemp/graphs/graph_data/Global_Mean_Estimates_based_on_Land_and_Ocean_Data/graph.txt")
head(mmodern_T
)
head(modern_T)
plot(modern_T$year,modern_T$T_anomaly)
head(ice_core_T)
plot(ice_core_T$Deuterium,ice_core_T$Temperature)
ice_core_T$Deuterium
hist(ice_core_T$Deuterium)
plot(-abs(ice_core_T$Deuterium),ice_core_T$Temperature)
load("/Users/jrprice/Downloads/polar.Rdata")
head(ice_core)
plot(ice_core$d18O,ice_core$Temperature)
plot(ice_core$Deuterium,ice_core$Temperature)
plot(ice_core$d18O,ice_core$Temperature)
usethis::use_data(ice_core,ice_core)
setwd("~/Dropbox/Teaching/Math 160/Math160UPS")
usethis::use_data(ice_core,ice_core)
document()
linreg()
find_residuals()
head(ice_core)
head(isotope_and_T)
usethis::use_data(isotope_and_T)
document()
linreg()
linreg()
linreg()
usethis::use_data(ice_core)
linreg()
linreg()
T_predicted = 1.52381164354435*ice_core$d18O+76.9067492353919
plot(ice_core$Agedecimal,T_predicted + 49,type = "l")
plot(ice_core$Age_decimal,T_predicted + 49,type = "l")
lines(ice_core$Age_decimal, ice_core$Temperature, col=”blue”)
lines(ice_core$Age_decimal, ice_core$Temperature, col="blue")
lines(ice_core$Age_decimal, ice_core$Temperature+49, col="blue")
plot(ice_core$Age_decimal,ice_core$Temperature)
plot(ice_core$Age_decimal,ice_core$Temperature,type = "l")
par(new = TRUE)
usethis::use_data(ice_core_co2)
plot(ice_core_co2$Age_yearBP,ice_core_co2$CO2_ppmv,col = 'orange',xlab = "",ylab = "", axis = FALSE)
plot(ice_core_co2$Age_yearBP,ice_core_co2$CO2_ppmv,col = 'orange',xlab = "",ylab = "", axis = FALSE, type = "l")
plot(ice_core$Age_decimal,ice_core$Temperature,type = "l")
par(new = TRUE)
plot(ice_core_co2$Age_yearBP,ice_core_co2$CO2_ppmv,col = 'orange',xlab = "",ylab = "", axis = FALSE)
axis(4,col.axis = "orange")
plot(ice_core_co2$temperature,ice_core_co2$temperature)
plot(ice_core_co2$co2,ice_core_co2$temperature)
plot(ice_core_co2$co2,ice_core_co2$temperature)
plot(ice_core_co2$CO2_ppmv,ice_core_co2$temperature)
plot(ice_core_co2$temperature,ice_core_co2$CO2_ppmv)
cor(ice_core_co2$temperature,ice_core_co2$CO2_ppmv)
usethis::use_data(modern_polar)
plot(modern_polar$T,modern_polar$co2)
cor(modern_polar$T,modern_polar$co2)
cor(modern_polar$T,modern_polar$co2,use = complete.obs)
cor(modern_polar$T,modern_polar$co2,use = 'complete.obs')
linreg()
linreg()
data(bears)
View(bears)
get_residuals()
find_residuals()
plot(bears$LENGTH,bears$WEIGHT)
linreg2 <- function(){
cat("What is the name of the list with your x variable? \n")
varname1 = readline()
cat("What is the name of the list with your y variable? \n")
varname2 = readline()
if(grepl("$", varname1, fixed=TRUE)){
names = strsplit(varname1,"\\$")
frame = get(names[[1]][1])
x = frame[[names[[1]][2]]]
} else{
x = get(varname1)}
if(grepl("$", varname2, fixed=TRUE)){
names = strsplit(varname2,"\\$")
frame = get(names[[1]][1])
y = frame[[names[[1]][2]]]
} else{
y = get(varname2)}
plot(x,y,xlab=varname1,ylab=varname2)
regress = lm(y ~ x)
intercept = as.numeric(coefficients(regress)[1])
slope = as.numeric(coefficients(regress)[2])
cat(paste("The best fit line for these data is:"))
cat("\n")
cat(paste(varname2," = ",toString(slope)," x (",varname1,") + ",toString(intercept),sep=""))
# we can add this line to our plot with the function abline:
abline(regress)
cat("\n")
cat("\n")
cat("\n")
cat(paste("You can plot these data by typing:"))
cat("\n")
cat(paste("plot(",varname1,",",varname2,")",sep=""))
cat("\n")
cat("\n")
cat(paste("You can find the best fit line by typing:"))
cat("\n")
cat(paste("lm(",varname2,"~",varname1,")",sep=""))
cat("\n")
cat("\n")
cat(paste("You can add the best fit line to the plot by saving the model:"))
cat("\n")
cat(paste("model = lm(",varname2,"~",varname1,")",sep=""))
cat("\n")
cat("\n")
cat(paste("and then adding it to the plot:"))
cat("\n")
cat("abline(model)")
}
linreg()
linreg2()
find_residuals2 <- function(){
cat("What is the name of the list with your x variable? \n")
varname1 = readline()
cat("What is the name of the list with your y variable? \n")
varname2 = readline()
if(grepl("$", varname1, fixed=TRUE)){
names = strsplit(varname1,"\\$")
frame = get(names[[1]][1])
x = frame[[names[[1]][2]]]
} else{
x = get(varname1)}
if(grepl("$", varname2, fixed=TRUE)){
names = strsplit(varname2,"\\$")
frame = get(names[[1]][1])
y = frame[[names[[1]][2]]]
} else{
y = get(varname2)}
xnew = x[!is.na(x)&!is.na(y)]
ynew = y[!is.na(x)&!is.na(y)]
x = xnew
y = ynew
regress = lm(y ~ x)
intercept = as.numeric(coefficients(regress)[1])
slope = as.numeric(coefficients(regress)[2])
cat(paste("The best fit line for these data is:"))
cat("\n")
cat(paste(varname2," = ",toString(slope)," x (",varname1,") + ",toString(intercept),sep=""))
cat("\n")
cat("\n")
cat("\n")
cat(paste("You can find the residuals by saving the model:"))
cat("\n")
cat(paste("model = lm(",varname2,"~",varname1,")",sep=""))
cat("\n")
cat("\n")
cat(paste("and then typing:"))
cat("\n")
cat(paste("resid(model)\n"))
print(resid(regress))
cat("\n")
cat("\n")
cat(paste("To plot them, you first need to remove all NAs from",varname1,"and",varname2,"\n(beyond the scope of this course), then type:\n"))
cat(paste("plot(",varname1,",resid(model))",sep=""))
plot(x,resid(regress),xlab=varname1,ylab="Residual")
abline(0,0)
}
find_residuals()
find_residuals2()
document()
